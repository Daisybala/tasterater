{% extends 'base.html' %} {% block content %}

<h1>Find Food Near You</h1>
<form method="get">
  <label for="term">Search Term:</label>
  <input type="text" id="term" name="term" required />
  <label for="location">Location:</label>
  <input type="text" id="location" name="location" required />
  <button type="submit">Search</button>
</form>

{% if results %}
<h2>Results:</h2>
<ul>
  {% for business in results %}
  <li>
    <h3><a href="{% url 'restaurant_detail' yelp_id=business.id %}">{{ business.name }}</a></h3>
    <p>Rating: {{ business.rating }}</p>
    <p>Address:  {{ business.location.address1 }} <a href="https://www.google.com/maps/dir/?api=1&destination={{ business.location.address1|urlencode }}" target="_blank">Click here for directions</a></p>
    {% if business.image_url %}
    <img src="{{ business.image_url }}" alt="Image of {{ business.name }}" style="width:200px;height:auto;">
    {% endif %}
    {% if user.is_authenticated %}
    <a href="{% url 'add_favorite' business.id %}">Favorite</a>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <a href="{% url 'add_review' business.id %}">Add Review</a>
    {% endif %}
  </li>
  {% endfor %}
  {% endif %}
</ul>
{% if user.is_authenticated %}
 <h2>Your Favorites</h2>
 <ul>
    {% for favorite in user.favorite_set.all %}
     <li>
        <h3>{{ favorite.restaurant.name }}</h3>
        <a href="{% url 'remove_favorite' favorite.restaurant.yelp_id %}">Remove Favorite</a>
     </li>
     {% endfor %}
 </ul>

<h2>Your Reviews</h2>
<ul>
  {% for review in user.review_set.all %}
  <li>
    <h3>{{ review.restaurant.name }}</h3>
    <p>{{ review.text }}</p>
    <p>Rating: {{ review.rating }}</p>
    <a href="{% url 'edit_review' review.id %}">Edit Review</a>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <a href="{% url 'delete_review' review.id %}">Delete Review</a>
  </li>
  {% endfor %}
</ul>
{% endif %}  {% endblock %}
